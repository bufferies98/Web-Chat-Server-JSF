<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

   <h:head>
      <title>Software AG | Web Chat</title>
   </h:head>

   <p:growl id="growl" showDetail="true"/>
       <h:form id="form">
           <p:remoteCommand name="updateList" update="users" process="@this"/>

           <p:fieldset id="container" legend="PrimeChat" toggleable="true">

               <h:panelGroup rendered="#{viewHandler.loggedIn}">
                   <h:panelGrid columns="2" columnClasses="publicColumn,usersColumn" style="width:100%">
                       <p:outputPanel id="public" layout="block" styleClass="ui-corner-all ui-widget-content chatlogs" />

                       <p:dataList id="users" var="user" value="#{viewHandler.users}" styleClass="usersList">
                           <f:facet name="header">
                               Users
                           </f:facet>

                           <!--<p:commandButton title="Chat" icon="ui-icon-comment" oncomplete="PF('pChat').show()" update=":form:privateChatContainer">
                               <f:setPropertyActionListener value="#{user}" target="#{ViewHandler.privateUser}" />
                           </p:commandButton> -->
                       </p:dataList>
                   </h:panelGrid>

                   <p:separator />

                   <p:inputText value="#{viewHandler.message}" styleClass="messageInput" />
                   <p:spacer width="5" />
                   <p:commandButton value="Send" actionListener="#{viewHandler.sendMessage}" oncomplete="$('.messageInput').val('').focus()" />
                   <p:spacer width="5" />
                   <p:commandButton value="Disconnect" actionListener="#{viewHandler.disconnect}" global="false" update="container" />
               </h:panelGroup>

               <h:panelGroup rendered="#{not viewHandler.loggedIn}" >
                   Username: <p:inputText value="#{viewHandler.username}" disabled="true" />

                   <p:spacer width="5" />
                   <p:commandButton value="Login" actionListener="#{viewHandler.login}" update="container"
                                    icon="ui-icon-person" disabled="true" />
               </h:panelGroup>

           </p:fieldset>
        </h:form>
</html>
